<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ูุดู ุฃุณุนุงุฑ ููุนุฑุถ ุฃุจู ุฑุงูุฒ</title>
<style>
body { font-family: Arial; margin: 40px; padding: 20px; }
h1 { text-align:center; }
.search-box { text-align:center; margin-bottom:20px; }
input[type="text"] { padding:8px; font-size:16px; margin:5px; }
button { padding:8px 12px; font-size:16px; cursor:pointer; margin:5px; }
mark { background-color: yellow; }
table { border-collapse: collapse; width:100%; margin-top:20px; }
th, td { border:1px solid #333; padding:8px; text-align:right; }
th { background-color:#f2f2f2; }
.hidden { display:none; }
#resultCount { text-align:center; margin-top:10px; font-weight:bold; color:#444; }
#invoiceTable th, #invoiceTable td { text-align:right; }
#total { font-weight:bold; margin-top:10px; text-align:right; }
</style>
</head>
<body>

<h1>ูุดู ุฃุณุนุงุฑ ููุนุฑุถ ุฃุจู ุฑุงูุฒ</h1>

<div style="text-align:center; margin-bottom:20px;">
  <button id="createInvoiceBtn">ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ๐ฐ</button>
</div>

<div id="invoiceSection" style="display:none;">
<h2 style="text-align:center;">ุงููุงุชูุฑุฉ</h2>
<table id="invoiceTable">
<thead>
<tr><th>ุงูุตูู</th><th>ุงูุณุนุฑ</th><th>ุฅุฌุฑุงุก</th></tr>
</thead>
<tbody></tbody>
</table>
<div id="total">ุงูุฅุฌูุงูู: 0</div>
</div>

<div class="search-box">
<input type="text" id="searchInput" placeholder="ุงูุจุณ ููู ูุณูู ุจุญุซ ๐">
<button id="searchBtn">ุจุญุซ</button>
<button id="clearBtn">ูุณุญ โ๏ธ</button>
<p>
<div style="background-color:#1D70B8;color:white;padding:5px 15px;border-radius:5px;display:inline-block;box-shadow:1px 1px 4px rgba(0,0,0,0.2);">
<h4 style="margin:0;">ุชุตููู ูุชูููุฐ ุงููุจุฑูุฌ ุฑุงูุฒ ๐ฏ</h4>
</div>
</p>
</div>

<div id="resultCount"></div>

<div id="content">
<table id="priceTable">
<thead>
<tr><th>ุฑูู ุงูุตูู</th><th>ุงูุตูู</th><th>ุงูุณุนุฑ</th><th>ุฅุฌุฑุงุก</th></tr>
</thead>
<tbody>
<tr><td>I00000001</td><td>ุบุณุงูุฉ ุงู ุฌู 10.5 ูููู ุณููุฑ LG V3</td><td>2520.00</td></tr>
<tr><td>I00000002</td><td>ุบุณุงูุฉ ุงู ุฌู 9 ูููู V4</td><td>2230.00</td></tr>
<tr><td>I00000003</td><td>ุบุณุงูุฉ ููุฑ 10 ูููู ุณููุฑ ุฏุงูุฑูุช ููุดู HW100-B14636NS3</td><td>1900.00</td></tr>
<tr><td>I00000004</td><td>ุบุณุงูุฉ ููุฑ 10 ูููู ุฏุงูุฑูุช ุฏุฑุงูู HW120</td><td>2100.00</td></tr>
<tr><td>I00000005</td><td>ุบุณุงูุฉ ุฌููุฑุงู ูููุณ 5 ูููู ุงุณูุฏ GLX-682B</td><td>840.00</td></tr>
<tr><td>I00000006</td><td>ุบุณุงูุฉ ููุฌุฑ ููู 9 ูููู ุณููุฑ</td><td>1250.00</td></tr>
<tr><td>I00000007</td><td>ูุฑูุฒุฑ ุจุฑุณุชูุฌ ุงุณูุฏ ููุงุก 6 ุฌูุงุฑูุฑ PR241</td><td>1300.00</td></tr>
</tbody>
</table>
</div>

<script>
const invoiceSection = document.getElementById('invoiceSection');
const invoiceTable = document.getElementById('invoiceTable').querySelector('tbody');
const totalDiv = document.getElementById('total');
const createInvoiceBtn = document.getElementById('createInvoiceBtn');
const searchInput = document.getElementById('searchInput');
const searchBtn = document.getElementById('searchBtn');
const clearBtn = document.getElementById('clearBtn');
const resultCount = document.getElementById('resultCount');
const priceTable = document.getElementById('priceTable').querySelector('tbody');

// ุชูุนูู ุธููุฑ ุงููุงุชูุฑุฉ
createInvoiceBtn.addEventListener('click', () => { invoiceSection.style.display='block'; });

// ุชุญุฏูุซ ุงูุฅุฌูุงูู
function updateTotal() {
  let sum = 0;
  Array.from(invoiceTable.rows).forEach(row => {
    sum += parseFloat(row.cells[1].innerText.replace(/,/g,'')) || 0;
  });
  totalDiv.innerText = `ุงูุฅุฌูุงูู: ${sum.toLocaleString()}`;
}

// ุฅุถุงูุฉ ุตู ูููุงุชูุฑุฉ
function addToInvoice(name, price) {
  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${name}</td><td>${price}</td><td><button class="removeBtn">ุญุฐู</button></td>`;
  invoiceTable.appendChild(tr);
  updateTotal();

  tr.querySelector('.removeBtn').addEventListener('click', () => {
    tr.remove();
    updateTotal();
  });
}

// ุจุญุซ ุฐูู
function smartSearch() {
  const input = searchInput.value.trim().toLowerCase();
  let matches = 0;
  Array.from(priceTable.rows).forEach(row => {
    // ุฅุนุงุฏุฉ ุงููุต ุงูุฃุตูู ุจุฏูู ุชุธููู
    row.cells[0].innerText = row.cells[0].dataset.original || row.cells[0].innerText;
    row.cells[1].innerText = row.cells[1].dataset.original || row.cells[1].innerText;
    row.cells[2].innerText = row.cells[2].dataset.original || row.cells[2].innerText;

    let rowText = row.cells[0].innerText + ' ' + row.cells[1].innerText + ' ' + row.cells[2].innerText;
    if(input === '' || input.split(/\s+/).every(word => rowText.toLowerCase().includes(word))) {
      row.classList.remove('hidden');
      matches++;

      // ุฅุถุงูุฉ ุงูุฒุฑ ุฅุฐุง ูู ููู ููุฌูุฏูุง
      if(!row.querySelector('.addBtn')) {
        const btn = document.createElement('button');
        btn.innerText = 'ุฅุถุงูุฉ ูููุงุชูุฑุฉ';
        btn.classList.add('addBtn');
        btn.addEventListener('click', () => addToInvoice(row.cells[1].innerText, row.cells[2].innerText));
        const cell = row.insertCell(3);
        cell.appendChild(btn);
      }
    } else {
      row.classList.add('hidden');
    }
  });

  resultCount.innerText = matches>0?`ุนุฏุฏ ุงููุชุงุฆุฌ: ${matches}`:'ูุง ุชูุฌุฏ ูุชุงุฆุฌ ูุทุงุจูุฉ ๐';
}

// ุญูุธ ุงููุต ุงูุฃุตูู ููู ุฎููุฉ
Array.from(priceTable.rows).forEach(row=>{
  Array.from(row.cells).forEach(cell=>cell.dataset.original = cell.innerText);
});

// ุฃุญุฏุงุซ ุงูุจุญุซ
searchInput.addEventListener('input', smartSearch);
searchBtn.addEventListener('click', smartSearch);
clearBtn.addEventListener('click', () => { searchInput.value=''; smartSearch(); });

// ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุงูุฅุถุงูุฉ ุนูุฏ ุงูุชุญููู
smartSearch();
</script>

</body>
</html>
